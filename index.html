<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <title>Lorem Ipsum Sucka</title>
</head>
<body>
<form id="formCapturePOC">
<label>First Name</label><input name="firstname" type="text">
<label>Last Name</label><input name="lastname" type="text">
<label>Email</label><input name="email" type="text">
  <select class="form-dropdown is-active" id="input_12" name="q12_howDid" style="width:310px" data-component="dropdown" aria-label="How did you find us?">
              <option value="">Please Select</option>
              <option value="Cancer Council Resource">Cancer Council Resource</option>
              <option value="CCQ staff/volunteers">CCQ staff/volunteers</option>
              <option value="Non Cancer council run conference">Non Cancer council run conference</option>
              <option value="Word of Mouth ">Word of Mouth </option>
              <option value="Internet Search ">Internet Search </option>
              <option value="Paper/Magazine ">Paper/Magazine </option>
              <option value="Radio">Radio</option>
              <option value="Television">Television</option>
              <option value="Medical/Allied Health Professional">Medical/Allied Health Professional</option>
              <option value="Social Media ">Social Media </option>
              <option value="Phone Book ">Phone Book </option>
              <option value="Non-Cancer Council Resource">Non-Cancer Council Resource</option>
            </select>
<button type="submit">Submit
</button>
</form>

<script src='https://cxppusa1formui01cdnsa01-endpoint.azureedge.net/oce/FormCapture/FormCapture.bundle.js'></script>
<script>
    // NOTE: for reference see https://go.microsoft.com/fwlink/?linkid=2250770

    d365mktformcapture.waitForElement("#formCapturePOC") // example: "#form1" as a selector for form with id="form1"
    .then(form => {
        const mappings = [
            {
                FormFieldName: "firstname",
                DataverseFieldName: "firstname",
            },
            {
                FormFieldName: "lastname",
                DataverseFieldName: "lastname",
            },
            {
                FormFieldName: "email",
                DataverseFieldName: "emailaddress1",
            },
            {
                FormFieldName: "input_12",
                DataverseFieldName: "howfound",
            },

        ];

        form.addEventListener("submit", (e) => {
            const serializedForm = d365mktformcapture.serializeForm(form, mappings);
            // console.log(JSON.stringify(serializedForm)); // NOTE: enable for debugging
            const payload = serializedForm.SerializedForm.build();

            const captureConfig = {
                FormId: "2f468d4b-14bc-ef11-a72f-6045bd40a8b5",
                FormApiUrl: "https://public-oce.mkt.dynamics.com/api/v1.0/orgs/7a597da6-1198-ef11-8a66-002248942acb/landingpageforms"
            }
            d365mktformcapture.submitForm(captureConfig, payload);
        }, true);
    });
</script>
</body>
</html>
